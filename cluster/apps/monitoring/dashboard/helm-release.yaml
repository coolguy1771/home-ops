---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: dashboard
  namespace: monitoring
  annotations:
    forecastle.stakater.com/expose: "true"
    forecastle.stakater.com/icon: ""
    cert-manager.io/cluster-issuer: letsencrypt-production
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://kubernetes.github.io/dashboard
      chart: dashboard
      version: 2.11.1
      sourceRef:
        kind: HelmRepository
        name: kubernetes-dashboard-charts
        namespace: flux-system
  values:
    image:
      repository: kubernetesui/dashboard
      tag: v2.2.0
      pullPolicy: IfNotPresent
      pullSecrets: []
    replicaCount: 1
## Additional container arguments
##
# extraArgs:
#   - --enable-skip-login
#   - --enable-insecure-login
#   - --system-banner="Welcome to Kubernetes"
    resources:
      requests:
        cpu: 100m
        memory: 200Mi
      limits:
        cpu: 2
        memory: 200Mi
  # LoadBalancerSourcesRange is a list of allowed CIDR values, which are combined with ServicePort to
  # set allowed inbound rules on the security group assigned to the master load balancer
  # loadBalancerSourceRanges: []
    ingress:
      enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
      kubernetes.io/tls-acme: 'true'
      nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    hosts:
      - k3s.witlinserver.com
    tls:
      - secretName: k3s.witlinserver.com
        hosts:
          - k3s.witlinserver.com
    settings:
    ## Cluster name that appears in the browser window title if it is set
      # clusterName: ""
    ## Max number of items that can be displayed on each list page
      itemsPerPage: 25
    ## Number of seconds between every auto-refresh of logs
      logsAutoRefreshTimeInterval: 5
    ## Number of seconds between every auto-refresh of every resource. Set 0 to disable
      resourceAutoRefreshTimeInterval: 5
    ## Hide all access denied warnings in the notification panel
    # disableAccessDeniedNotifications: false
    pinnedCRDs: []
    # - kind: customresourcedefinition
    ##  Fully qualified name of a CRD
    #   name: prometheuses.monitoring.coreos.com
    ##  Display name
    #   displayName: Prometheus
    ##  Is this CRD namespaced?
    #   namespaced: true
    metricsScraper:
      enabled: true
      image:
        repository: kubernetesui/metrics-scraper
        tag: v1.0.6
    metrics-server:
      enabled: true
    ## Example for additional args
    # args:
    #  - --kubelet-preferred-address-types=InternalIP
    #  - --kubelet-insecure-tls
